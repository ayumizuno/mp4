---
title: "mp4"
author: "Sunnie Ning & Ayumi Mizuno"
date: "November 27, 2017"
output: 
  html_document:
    fig_width: 7
    fig_height: 6
    df_print: paged 
    code_folding: hide
---
The date is `r format(Sys.Date(), "%B %e, %Y")` 
#Big Budget = Top Box Office? Not so for Disney Animations


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r message= FALSE, warning=FALSE, include=FALSE}
library(mdsr)
library(RMySQL)
library(dplyr)
library(ggplot2)
library(stringr)
library(ggthemes)

db <- dbConnect_scidb(dbname = "imdb")
```
```{r ECHO=FALSE, include=FALSE}
disney <- db %>%
  dbGetQuery("SELECT DISTINCT (t.id),t.title, t.production_year, mi.info, mi3.info FROM company_name cn
              JOIN movie_companies mc ON mc.company_id = cn.id
              JOIN title t ON mc.movie_id = t.id
              JOIN movie_info mi on mi.movie_id = t.id
              JOIN movie_info mi2 on mi2.movie_id = t.id
              JOIN movie_info mi3 on mi3.movie_id = t.id
              WHERE cn.name LIKE '%Walt Disney%'
              AND t.kind_id = 1
              AND mi.info_type_id=105
             AND mi2.info_type_id = 3
            AND mi2.info = 'Animation'
            AND mi3.info_type_id=107
              AND mi3.info LIKE '%(USA)'")

colnames(disney)[4]= "budget"
colnames(disney)[5]= "gross"
save(disney,file = "Disney.rda")
```

```{r, include=FALSE}
load("Disney.rda")
```
```{r, include=FALSE}
disney_clean <- disney %>% 
  filter(id != 3792055 & id != 3968288) %>%
  select(-id) %>%
  arrange(production_year) %>% 
  mutate(gross = str_extract(strsplit(gross,' '),"[[0-9]+,]+")) %>% 
  mutate(gross = as.numeric(gsub(",","",gross))) %>% 
  mutate(budget= str_extract(strsplit(budget,' '),"[[0-9]+,]+")) %>% 
  mutate(budget = as.numeric(gsub(",","",budget)))

disney_clean <- disney_clean %>%
  mutate(decade = (production_year %/% 10)*10, profit = gross-budget) 
```

From Three Little Pigs in 1937 to the newest release Coco, Disney animations are an all-time favorite, attracting curious kids and nostalgic adults alike. The cost of making animations have soared exponentially, with a competitive market, sophisticated technologies, and ever-expanding crew. Behind the glamorous production, however, the profit might no longer justify the cost. 


To investigate this relationship between profit and cost, we pulled Disney animations data from the IMDB database, from Three Little Pigs in 1933 that runs for eight minutes, to the smartphone-themed unsuccessful The Emoji Movie in 2017. The data confirm our gut feeling that an increase in both the cost and the box office is a definite trend over time, but the relationship between cost and profit is muddier.


```{r, echo=FALSE, warning=FALSE, message=FALSE}
p2<-ggplot(disney_clean,aes(x =budget, y = profit)) +
  geom_point(aes(color = factor(decade)),position='dodge')+
  scale_color_discrete(labels = c('1930', '1940', '1950', '1960', '1970', '1980', '1990', '2000', '2010'))+
  geom_smooth(method = 'lm') +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  xlab("Budget ($)")+
  ylab("Profit ($)")+
  ggtitle("Profit and Budget of Movies by Decade")+
  theme(legend.title=element_blank())+
  scale_color_brewer(palette="Set1")

p2
```



But big-budget films don’t always reap good box office. In fact, the scatter plot shows that the relationship can be slightly negative. Interestingly, more box office bombs are produced in 2000 than in any other era. The greatest box-office disaster on our list, Treasure Planet (2006), cost around $100 million more than it made.
Our data is the exponential increase in average budget over time. The average profit shows a downward trend ever since 1960, the decade filled with classic Disney animations such as The Jungle Book and One Hundred and One Dalmatians. The sum of budget and profit over decades show the same trend. 



```{r, echo=FALSE}
disney_mean <- disney_clean %>%
  select(decade, title, profit, budget) %>%
  group_by(decade) %>%
  summarize(Profit = mean(profit),
            Budget = mean(budget)) %>%
  gather(key = 'type', value = 'value',Profit,Budget )
p5<-ggplot(disney_mean,aes(x=factor(decade), y = value, fill = type)) +
  geom_bar(stat="identity", position= "dodge")+
  scale_y_continuous(labels = scales::comma) +
  scale_fill_brewer(palette= 'Set1')+
  xlab("")+
  ylab("Profit ($)")+
  ggtitle("Mean Profit and Budget per Animation by Decade")
p5
```

It is no secret that animation films cost hundreds of millions more today than in the golden age of animated films like Pinocchio with a budget of 2.6M US dollars. This increase is unsurprising: times have changed, teams are bigger, technology is more expensive than pencils and paint. According to James Cole, on average most animated films today can range anywhere from 2M to 250M. Some of the money will go to the writers, some to storyboard artists, some to background artists, layout artists, animators, directors and most of the budget go to the stars. Another factor that may have inflated the budget could be competition. With many more studios joining the animation genre, it is hard to keep the budget down. This budget inflation does not include the additional $150 million that goes into promotion.


With a budget running high and box-office going downhill, why are producers still plunging into this dangerous zone?
Even though animations are making less, animated movies are still the most profitable genre, averaging a 36 percent return over the past decade, according to The Seattle Times. A high budget animation is a risk, but spending more to produce a quality piece may result in favorable earnings such as Finding Dory was able to do.


```{r, echo=FALSE}
top20profit <- disney_clean %>%
  arrange(desc(profit)) %>%
  head(20)

profit_plot <- ggplot(top20profit, aes(x=reorder(title, profit), y=profit))+
  geom_bar(stat="identity", aes(fill=factor(decade)))+
  geom_point(aes(y=budget), color="red")+
  annotate("text", x = "Finding Nemo", y = 120000000, label = "budget", color="red")+
  geom_text(aes(label=paste("$", profit%/%1000000, "m",sep=""), hjust=0))+
  scale_y_continuous(limits = c(0, 3.5e+08), expand=c(0,0),labels = scales::comma) +
  ggtitle("Top 20 Profitable Movies")+
  xlab("")+
  ylab("Profit ($)")+
  coord_flip()+
  scale_fill_brewer(palette="GnBu")+
  theme(legend.title=element_blank())


profit_plot
```


The top 20 profitable Disney animations chart confirm this perspective. The most profitable movies are the ones that came out more recently. Films produced in the 2000s and 2010s dominate the chart, with Finding Nemo and Finding Dory at the top. 


Additionally, the top five movies with the highest budget are all from the 2010s: Finding Dory, Inside Out, Zootopia, Frozen, and Moana.


On the other hand, most of the industry looks away from box-office for profits. According to the Seattle Times, financiers are increasingly emboldened by the potential for fat returns outside of theaters. “Frozen,” with its massive $1.3 billion in ticket sales, was dwarfed by an estimated $6 billion in ancillary product revenue. “Producers are almost thinking more about that side of the business and certainly earlier than ever before,” Piper Jaffray analyst Stan Meyer said. “It’s gone from toys to food and clothes and a bunch of other categories.”


One reason for the success of animations might be its lure to adult and kids alike. A Forbes article even points out that the most successful animations target adult audience more than children. “Sure, there are kid moviegoers who want to see whatever the latest big animated feature happens to be, and there are parents who will drag their kids to whatever the big animated feature happens to be. But with all the talk about younger people not flocking to theaters and average moviegoers getting somewhat older, perhaps a generation raised on VOD and unlimited kid-friendly content at the push of a button doesn’t necessarily consider another Smurfs movie to be a must-see event,” reasoned Scott Mendelson, the author of the article.


 
Interestingly, before recent decades, the budget of an animation did not seem to have much influence on how well the film performed. Although all of the movies in the top 20 produced during and before the 1960s had low budgets, they were extremely profitable. 


Take, for example, *Snow White and the Seven Dwarfs*(1937), the most profitable Disney animation before the 1990s. This animation was a massive hit despite low budget because it was the first full-length animation and the first Walt Disney Animation Studios film. The meaningful context of this film's production explains its popularity and returns. 


Another notable movie is The Lion King (1994), an unexpected success earning seven times its budget. Various factors contributed to the ultimate success of The Lion King. The Lion King was Disney's first story created just for a film, featuring natural sceneries in African grassland quite distant from European settings familiar to the audience. Instead of princesses and castles, lions and hyenas appealed to a global market. 


Classics like Snow White and Lion King have become historical milestones, cultural icons, and source of nostalgia, and continue to gain the upper hand in competition with new animations. The Lion King made a greater profit than Frozen with the lowest budget out of the top three most profitable films. 


Even though Disney has mostly abandoned small production animations, some studios of today are still making low budget animated films for a few million or more. The Missing Lynx, budgeted at 6.5 Million produced by Spanish studios Kandor Graphics and YaYa! Films, is an example. These films tend to have a smaller box office, but target DVD sale to make up the difference.


In general, our data show that an animation’s success depends on more than merely its budget. The ever-rising budget of animations might reflect Hollywood’s blockbuster gambling addiction as much as its profitability. It is dangerous pouring money into a buzzing genre eyeing grand slams like Frozen regardless of the general box-office trend: it’s not that there isn’t demand; it’s just there’s an awful lot of supply.




